/*! Angular Feature Flags v0.3.1 Â© 2014 Michael Taranto */
!function(){angular.module("feature-flags",[]),angular.module("feature-flags").directive("featureFlag",["featureFlags",function(e){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,compile:function(a,t){return a[0].textContent=" featureFlag: "+t.featureFlag+" is off ",function(a,t,r,n,l){var i,s;a.$watch(function(){return e.isOn(r.featureFlag)},function(e){e?(s=a.$new(),l(s,function(e){i=e,t.after(i).remove()})):(s&&(s.$destroy(),s=null),i&&(i.after(t).remove(),i=null))})}}}}]),angular.module("feature-flags").directive("featureFlagOverrides",["featureFlags",function(e){return{restrict:"A",link:function(a){a.flags=e.get(),a.isOn=e.isOn,a.isOverridden=e.isOverridden,a.enable=e.enable,a.disable=e.disable,a.reset=e.reset},template:'<div class="feature-flags">    <h1>Feature Flags</h1>    <div class="feature-flags-flag" ng-repeat="flag in flags">        <div class="feature-flags-name">{{flag.name}}</div>        <div class="feature-flags-switch" ng-click="enable(flag)" ng-class="{\'active\': isOverridden(flag.key) && isOn(flag.key)}">ON</div>        <div class="feature-flags-switch" ng-click="disable(flag)" ng-class="{\'active\': isOverridden(flag.key) && !isOn(flag.key)}">OFF</div>        <div class="feature-flags-switch" ng-click="reset(flag)" ng-class="{\'active\': !isOverridden(flag.key)}">DEFAULT</div>        <div class="feature-flags-desc">{{flag.description}}</div>    </div></div>',replace:!0}}]),angular.module("feature-flags").service("featureFlagOverrides",["$rootElement",function(e){var a=e.attr("ng-app");return{isPresent:function(e){return null!==localStorage.getItem("featureFlags."+a+"."+e)},get:function(e){return localStorage.getItem("featureFlags."+a+"."+e)},set:function(e,t){localStorage.setItem("featureFlags."+a+"."+e,t)},remove:function(e){localStorage.removeItem("featureFlags."+a+"."+e)},reset:function(){for(var e in localStorage)0===e.indexOf("featureFlags."+a+".")&&localStorage.removeItem(e)}}}]),angular.module("feature-flags").service("featureFlags",["$http","featureFlagOverrides",function(e,a){var t={},r=[],n=function(){return r},l=function(e){var a=e.success||e.then;return a.call(e,function(e){e.forEach(function(e){t[e.key]=e.active,e.active=c(e.key)}),angular.copy(e,r)})},i=function(e){e.active=!0,a.set(e.key,!0)},s=function(e){e.active=!1,a.set(e.key,!1)},f=function(e){e.active=t[e.key],a.remove(e.key)},u=function(e){return a.isPresent(e)},c=function(e){return u(e)?"true"==a.get(e):t[e]};return{set:l,get:n,enable:i,disable:s,reset:f,isOn:c,isOverridden:u}}])}();