/*!
 * Angular Feature Flags v0.3.0
 *
 * Copyright 2014, Michael Taranto
 */
!function(){angular.module("feature-flags",[]).value("FLAGS_URL","data/flags.json").run(["flags",function(e){e.fetch()}]),angular.module("feature-flags").directive("featureFlag",["flags",function(e){return{restrict:"A",link:function(a,t,n){var r=document.createComment(" featureFlag: "+n.featureFlag+" "),i=function(e,a){var t=e.parentNode;t&&t.replaceChild(a,e)};a.$watch(function(){return e.isOn(n.featureFlag)},function(e){e===!1?i(t[0],r):i(r,t[0])})}}}]),angular.module("feature-flags").service("flags",["$http","FLAGS_URL","override",function(e,a,t){var n={},r=[],i=function(){return r},l=function(){return e.get(a).success(function(e){e.forEach(function(e){n[e.key]=e.active,e.active=g(e.key)}),angular.copy(e,r)})},s=function(e){e.active=!0,t.set(e.key,!0)},c=function(e){e.active=!1,t.set(e.key,!1)},f=function(e){e.active=n[e.key],t.remove(e.key)},u=function(e){return t.isPresent(e)},g=function(e){return u(e)?"true"==t.get(e):n[e]};return{fetch:l,get:i,enable:s,disable:c,reset:f,isOn:g,isOverridden:u}}]),angular.module("feature-flags").service("override",["$rootElement",function(e){var a=e.attr("ng-app");return{isPresent:function(e){return null!==localStorage.getItem(a+"."+e)},get:function(e){return localStorage.getItem(a+"."+e)},set:function(e,t){localStorage.setItem(a+"."+e,t)},remove:function(e){localStorage.removeItem(a+"."+e)}}}]),angular.module("feature-flags").directive("overridePanel",["flags",function(e){return{restrict:"A",link:function(a){a.flags=e.get(),a.isOn=e.isOn,a.isOverridden=e.isOverridden,a.enable=e.enable,a.disable=e.disable,a.reset=e.reset},template:'<div class="feature-flags">    <h1>Feature Flags</h1>    <div class="feature-flags-flag" ng-repeat="flag in flags">        <div class="feature-flags-name">{{flag.name}}</div>        <div class="feature-flags-switch" ng-click="enable(flag)" ng-class="{\'active\': isOverridden(flag.key) && isOn(flag.key)}">ON</div>        <div class="feature-flags-switch" ng-click="disable(flag)" ng-class="{\'active\': isOverridden(flag.key) && !isOn(flag.key)}">OFF</div>        <div class="feature-flags-switch" ng-click="reset(flag)" ng-class="{\'active\': !isOverridden(flag.key)}">DEFAULT</div>        <div class="feature-flags-desc">{{flag.description}}</div>    </div></div>',replace:!0}}])}();