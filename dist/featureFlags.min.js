/*! Angular Feature Flags v0.0.1 Â© 2014 Michael Taranto */
!function(){angular.module("feature-flags",[]),angular.module("feature-flags").directive("featureFlag",["featureFlags",function(e){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,compile:function(t,r){return t[0].textContent=" featureFlag: "+r.featureFlag+" is off ",function(t,r,a,n,i){var l,u;t.$watch(function(){return e.isOn(a.featureFlag)},function(e){e?(u=t.$new(),i(u,function(e){l=e,r.after(l).remove()})):(u&&(u.$destroy(),u=null),l&&(l.after(r).remove(),l=null))})}}}}]),angular.module("feature-flags").directive("featureFlagOverrides",["featureFlags",function(e){return{restrict:"A",link:function(t){t.flags=e.get(),t.isOn=e.isOn,t.isOverridden=e.isOverridden,t.enable=e.enable,t.disable=e.disable,t.reset=e.reset},template:'<div class="feature-flags">    <h1>Feature Flags</h1>    <div class="feature-flags-flag" ng-repeat="flag in flags">        <div class="feature-flags-name">{{flag.name}}</div>        <div class="feature-flags-switch" ng-click="enable(flag)" ng-class="{\'active\': isOverridden(flag.key) && isOn(flag.key)}">ON</div>        <div class="feature-flags-switch" ng-click="disable(flag)" ng-class="{\'active\': isOverridden(flag.key) && !isOn(flag.key)}">OFF</div>        <div class="feature-flags-switch" ng-click="reset(flag)" ng-class="{\'active\': !isOverridden(flag.key)}">DEFAULT</div>        <div class="feature-flags-desc">{{flag.description}}</div>    </div></div>',replace:!0}}]),angular.module("feature-flags").service("featureFlagOverrides",["$rootElement",function(e){var t=e.attr("ng-app"),r="featureFlags."+t+".",a=function(e){return r+e},n=function(e){return 0===e.indexOf(r)},i=function(e,t){localStorage.setItem(a(t),e)},l=function(e){return localStorage.getItem(a(e))},u=function(e){localStorage.removeItem(a(e))};return{isPresent:function(e){return null!==l(e)},get:l,set:function(e,t){angular.isObject(e)?angular.forEach(e,i):i(t,e)},remove:u,reset:function(){for(var e in localStorage)n(e)&&localStorage.removeItem(e)}}}]),angular.module("feature-flags").service("featureFlags",["$q","featureFlagOverrides",function(e,t){var r={},a=[],n=function(){return a},i=function(e){return angular.isArray(e)?d(u(e)):l(e)},l=function(e){return e.then(function(e){return u(e.data||e)})},u=function(e){return e.forEach(function(e){r[e.key]=e.active,e.active=g(e.key)}),angular.copy(e,a),a},f=function(e){e.active=!0,t.set(e.key,!0)},s=function(e){e.active=!1,t.set(e.key,!1)},c=function(e){e.active=r[e.key],t.remove(e.key)},o=function(e){return t.isPresent(e)},g=function(e){return o(e)?"true"==t.get(e):r[e]},d=function(t){var r=e.defer();return r.resolve(t),r.promise};return{set:i,get:n,enable:f,disable:s,reset:c,isOn:g,isOverridden:o}}])}();